# 优先队列（堆）

## 模型

优先队列是允许至少下列两种操作的数据结构：Insert（插入），它的工作是显而易见的，以及 DeleteMin（删除最小者），它的工作是找出，返回和删除优先队列中最小的元素。Insert 操作等价于 Enqueue（入队），而 DeleteMin 则是队列中 Dequeue（出队）在优先队列中的等价操作。

## 二叉堆（binary heap）

同二叉查找树一样，堆也有两个性质，即结构性和堆序性。

### 结构性质

堆是一棵完全填满的二叉树，有可能的例外是在底层，底层上的元素从左到右填入。这样的树被称为完全二叉树（complete binary tree）。

容易证明，一棵高为 h 的完全二叉树有 2^h 到 2^(h+1)-1 个节点。这意味着，完全二叉树的高是 log N，显然它是 O(log N)。

因为完全二叉树很有规律，所以它可以用一个数组表示而不需要指针。

对于数组中任一位置 i 上的元素，其左儿子在位置 2i 上，右儿子在左儿子后的单元 (2i+1) 中，它的父亲则在位置 i/2 上。这种实现方法的唯一问题在于，最大的堆大小需要事先估计，但对于典型情况这并不成问题。

一个堆数据结构将由一个数组、一个代表最大值的整数以及当前的堆大小组成。

### 堆序性质

在一个堆中，对于每一个节点 X，X 的父亲中的关键字小于（或等于）X 中的关键字，根节点除外（它没有父亲）。

### 基本的堆操作

#### Insert（插入）

插入操作一般使用的策略叫做上滤（percolate up)。为将一个元素 X 插入到堆中，我们在下一个空闲位置创建一个空穴，否则该堆将不是完全树。如果 X 可以放在该空穴中而并不破坏堆的序，那么插入完成。否则，我们把空穴的父节点上的元素移入该空穴中，这样，空穴就朝着根的方向上行一步。继续该过程直到 X 能被放入空穴中为止。

#### DeleteMin（删除最小元）

DeleteMin 以类似与插入的方式处理。找出最小元是容易的；困难的部分是删除它。当删除一个最小元时，在根节点处产生了一个空穴。由于现在堆少了一个元素，因此堆中最后一个元素 X 必须移动到该堆的某个地方。如果 X 可以被放到空穴中，那么 DeleteMin 完成。不过这一般不太可能，因此我们将空穴的两个儿子中较小者移入空穴，这样就把空穴向下对了一层。重复该步骤直到 X 可以被放入空穴中。因此，我们的做法是将 X 置入沿着从根开始包含最小儿子的一条路径上的一个正确的位置。

## 优先队列的应用

### 选择问题

输入 N 个元素，找出第 k 个最大的元素。
